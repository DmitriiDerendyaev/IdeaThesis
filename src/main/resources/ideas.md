# Структура базы данных

## 1. Таблица пользователей (`users`)

| Поле           | Тип данных      | Описание                                   |
|----------------|-----------------|--------------------------------------------|
| `user_id`      | BIGINT (PK)     | Уникальный идентификатор пользователя      |
| `telegram_id`  | BIGINT          | Telegram ID пользователя                   |
| `username`     | VARCHAR(255)    | Имя пользователя (может быть NULL)        |
| `created_at`   | TIMESTAMP       | Дата регистрации пользователя              |

---

## 2. Таблица компетенций (`competencies`)

| Поле             | Тип данных      | Описание                                   |
|------------------|-----------------|--------------------------------------------|
| `competency_id`  | BIGINT (PK)     | Уникальный идентификатор компетенции       |
| `competency_name`| VARCHAR(255)    | Название компетенции                       |
| `description`    | TEXT            | Описание компетенции (дополнительное поле)|

---

## 3. Таблица пользователей-компетенций (`user_competencies`)

| Поле                  | Тип данных      | Описание                                   |
|-----------------------|-----------------|--------------------------------------------|
| `user_competency_id`  | BIGINT (PK)     | Уникальный идентификатор записи            |
| `user_id`             | BIGINT (FK)     | Ссылка на таблицу пользователей            |
| `competency_id`       | BIGINT (FK)     | Ссылка на таблицу компетенций              |
| `created_at`          | TIMESTAMP       | Время добавления компетенции               |

---

## 4. Таблица областей и тем (`study_areas`)

| Поле           | Тип данных      | Описание                                   |
|----------------|-----------------|--------------------------------------------|
| `area_id`      | BIGINT (PK)     | Уникальный идентификатор области           |
| `area_name`    | VARCHAR(255)    | Название области дипломного проекта        |
| `description`  | TEXT            | Описание области (дополнительное поле)    |

---

## 5. Таблица пользователей-областей (`user_study_areas`)

| Поле                  | Тип данных      | Описание                                   |
|-----------------------|-----------------|--------------------------------------------|
| `user_study_area_id`  | BIGINT (PK)     | Уникальный идентификатор записи            |
| `user_id`             | BIGINT (FK)     | Ссылка на таблицу пользователей            |
| `area_id`             | BIGINT (FK)     | Ссылка на таблицу областей                 |
| `created_at`          | TIMESTAMP       | Время добавления области                   |

---

## 6. Таблица запросов (`user_requests`)

| Поле                  | Тип данных      | Описание                                   |
|-----------------------|-----------------|--------------------------------------------|
| `request_id`          | BIGINT (PK)     | Уникальный идентификатор запроса           |
| `user_id`             | BIGINT (FK)     | Ссылка на таблицу пользователей            |
| `competency_id`       | BIGINT (FK)     | Ссылка на таблицу компетенций              |
| `area_id`             | BIGINT (FK)     | Ссылка на таблицу областей                 |
| `request_time`        | TIMESTAMP       | Время создания запроса                     |
| `request_text`        | TEXT            | Текст запроса к LLM                        |

---

## 7. Таблица ответов (`responses`)

| Поле                  | Тип данных      | Описание                                   |
|-----------------------|-----------------|--------------------------------------------|
| `response_id`         | BIGINT (PK)     | Уникальный идентификатор ответа            |
| `request_id`          | BIGINT (FK)     | Ссылка на таблицу запросов                |
| `topic_id`            | BIGINT (FK)     | Ссылка на таблицу сгенерированных тем     |
| `response_time`       | TIMESTAMP       | Время создания ответа                      |

---

## 8. Таблица результатов генерации тем дипломных работ (`generated_topics`)

| Поле                  | Тип данных      | Описание                                   |
|-----------------------|-----------------|--------------------------------------------|
| `topic_id`            | BIGINT (PK)     | Уникальный идентификатор темы              |
| `request_id`          | BIGINT (FK)     | Ссылка на запрос пользователя              |
| `topic_name`          | VARCHAR(255)    | Название сгенерированной темы              |
| `description`         | TEXT            | Описание дипломной работы                  |
| `created_at`          | TIMESTAMP       | Время генерации темы                       |

---

## 9. Таблица состояний пользователя (`user_states`)

| Поле                  | Тип данных      | Описание                                   |
|-----------------------|-----------------|--------------------------------------------|
| `user_id`             | BIGINT (PK, FK) | Ссылка на пользователя                     |
| `stage`               | VARCHAR(50)     | Текущий этап общения с ботом              |
| `competencies`        | TEXT            | Введенные компетенции (на этапе заполнения) |
| `area_of_study`      | TEXT            | Введенная область (на этапе заполнения)   |
| `updated_at`          | TIMESTAMP       | Дата последнего обновления состояния       |
